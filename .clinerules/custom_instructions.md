# Ashenhall - カードゲーム開発ルール

重要：ユーザーから指定が無い限り、常に日本語で返答してください

## 核心制約（絶対に守る）

### 個人開発制約

- **保守性**: 1人で保守可能な複雑度を維持
- **時間制約**: 週10時間以内での運用維持
- **予算制限**: 月額$50以下での運用

### ゲーム設計の核心

- **デッキサイズ**: 20枚固定
- **勢力数**: 5勢力（死霊術師・戦狂い・魔導士・騎士・審問官）
- **戦闘速度**: 5秒以内
- **バランス目標**: 全勢力勝率45-55%

## 技術判断の優先順位

1. **将来の拡張性** > 短期的な開発速度
2. **保守性** > パフォーマンス
3. **学習コスト最小化** > 最新技術採用
4. **テスト容易性** > 実装の簡潔さ
5. **個人開発の持続可能性** > 技術的完璧さ

## 開発方針

### アーキテクチャ原則

- **決定論的システム**: 同条件なら常に同結果
- **ゲームロジック分離**: UI層とビジネスロジックの完全分離
- **段階的拡張**: 将来の機能追加を考慮した設計
- **テスト容易性**: ユニットテスト・AIバトルテスト重視

### コード品質基準

- TypeScript strict mode必須
- 戦闘ロジックは100%テストカバレッジ
- ゲーム状態はimmutable設計
- エラーハンドリングを全箇所で実装

### パッケージ管理

- **パッケージマネージャー**: pnpmを必ず使用（npmは使用禁止）
- **理由**: 高速な依存関係解決とディスク容量効率化

## 実装時の注意事項

### カード効果実装

- 各効果は独立したテスト可能な関数
- 効果値は0.5刻みでの微調整を前提
- 勢力間相互作用を常に考慮

### AI実装

- 各勢力の特色を明確に表現
- プレイヤーが学習できる一貫した行動
- 計算時間制限内での最適化

### データ設計

- 全戦闘ログの永続化・再現可能性
- ユーザーデータの移行可能性確保
- スケーラビリティを考慮した設計

## 開発プロセス原則

### 着手前の準備

- タスク関連ファイルだけでなく、依存・被依存ファイルも含めて全体像を把握
- 型定義、テスト、使用箇所を確認し、変更の影響範囲を理解
- プロジェクト固有の制約（デッキ20枚、5勢力、5秒戦闘）を常に意識

### 段階的実装

- 1機能/1ファイル/1テストケース単位で実装→検証を繰り返す
- 各段階で型チェックとテストを実行し、成功を確認してから次へ
- 決定論的システムのため、テストは確実に再現可能であるべき

### エラー対応

- 型エラー、テスト失敗、コンパイルエラーは即座に修正
- 設計判断（ファイル配置、パフォーマンストレードオフ、破壊的変更）は相談
- AI実装・バランス調整は複数の視点から検証

### 品質維持

- 戦闘ロジック変更時は必ず関連テストを実行（`pnpm test`）
- ゲーム状態のimmutability維持
- 個人開発の保守性を最優先（複雑な抽象化より明確なコード）
